<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel with QR Attendance</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f0f2f5;
    }
    h2, h3, h4 { margin-bottom: 10px; }
    #loginDiv, #adminContent {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    input[type="password"], input[type="text"], input[type="date"], input[type="month"], select {
      padding: 8px; width: calc(100% - 18px); margin-bottom: 10px; font-size: 16px;
    }
    button {
      padding: 10px 16px; font-size: 16px; cursor: pointer;
      border-radius: 4px; border: none; background: #007bff; color: white; margin-right: 10px;
      transition: background-color 0.3s ease;
    }
    button:hover:enabled { background: #0056b3; }
    button:disabled { background: #a0a0a0; cursor: not-allowed; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd; padding: 10px; text-align: center;
    }
    th { background: #007bff; color: white; }
    .present { background-color: #d4edda; }
    .absent { background-color: #f8d7da; }
    #logoutBtn { background: #6c757d; margin-top: 15px; }
    #logoutBtn:hover { background: #5a6268; }
    #qrModal, #modalOverlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5); justify-content: center; align-items: center; display: none;
      z-index: 9999;
    }
    #qrModalContent, #modal {
      background: white; padding: 20px; border-radius: 8px;
      width: 300px; max-width: 95%;
    }
  </style>
</head>

<body>

<!-- üîê Login Panel -->
<div id="loginDiv">
  <h2>Admin Login</h2>
  <input type="password" id="adminPass" placeholder="Enter Admin Password" />
  <button onclick="checkPassword()">Login</button>
  <p id="loginMsg" style="color:red;"></p>
</div>

<!-- üìã Admin Dashboard -->
<div id="adminContent" style="display:none;">
  <h2>Admin Attendance Dashboard</h2>
  <!-- View Attendance -->
  <label for="viewDate"><strong>üìÖ View Attendance By Date:</strong></label>
  <input type="date" id="viewDate" onchange="viewAttendanceByDate()" />
  <div id="dateDisplay"></div>
  <button onclick="showAddModal()">‚ûï Add New Student</button>

  <!-- QR Code Section -->
  <h3>üì≤ QR Code Generator</h3>
  <button onclick="generateAllQRCodes()">Generate All QR Codes</button>
  <button onclick="downloadAllQRAsPDF()">‚¨áÔ∏è Download All QR PDF</button>
  <button onclick="showIndividualQRModal()">Generate Individual QR</button>
  <div id="qrCodeContainer" style="margin-top: 20px;"></div>

  <!-- Student Table -->
  <table>
    <thead>
      <tr>
        <th>ID</th><th>Name</th><th>Mobile</th><th>Status</th><th>Actions</th><th>Photo</th>
      </tr>
    </thead>
    <tbody id="attendanceTableBody"></tbody>
  </table>

  <!-- Export Attendance -->
  <h3>üì§ Export Attendance</h3>
  <input type="date" id="exportDate" />
  <button onclick="exportAttendanceByDate()">Export</button>

  <!-- Monthly Summary -->
  <h3>üìä Monthly Attendance Summary</h3>
  <input type="month" id="monthPicker" />
  <button onclick="generateMonthlyReport()">Generate</button>
  <button onclick="exportMonthlyCSV()">Export Monthly CSV</button>
  <table id="monthlyTable" style="display:none;">
    <thead>
      <tr><th>ID</th><th>Name</th><th>Present Days</th><th>Total Days</th><th>Attendance %</th></tr>
    </thead>
    <tbody id="monthlyTableBody"></tbody>
  </table>

  <!-- Live Monthly Attendance Table -->
  <h3>üìÖ Live Monthly Attendance Dashboard (Click to Edit)</h3>
  <div id="liveDashboardContainer">
    <table id="liveDashboardTable" style="min-width: 1000px;">
      <thead id="liveTableHead"></thead>
      <tbody id="liveTableBody"></tbody>
    </table>
  </div>

  <button id="logoutBtn" onclick="logout()">Logout</button>
</div>

<!-- üßæ Add/Edit Student Modal -->
<div id="modalOverlay">
  <div id="modal">
    <h3 id="modalTitle">Add Student</h3>
    <input type="text" id="studentIdInput" placeholder="Student ID (unique)" />
    <input type="text" id="studentNameInput" placeholder="Student Name" />
    <input type="text" id="studentMobileInput" placeholder="Mobile Number" />
    <div style="text-align:right; margin-top:10px;">
      <button onclick="closeModal()">Cancel</button>
      <button onclick="saveStudent()">Save</button>
    </div>
    <p id="modalErrorMsg" style="color:red;"></p>
  </div>
</div>

<!-- üéØ Individual QR Modal -->
<div id="qrModal">
  <div id="qrModalContent">
    <h3>Generate Individual QR</h3>
    <select id="studentQRSelect"></select>
    <button onclick="generateStudentQR()">Generate</button>
    <button onclick="closeQRModal()" style="margin-top:10px;">Close</button>
  </div>
</div>

<!-- ‚úÖ Logic Script (Already working and optimized in your original) -->
<script>
  const BASE_URL = "https://attendance-app-5w9d.onrender.com";

(() => {
  const ADMIN_PASSWORD = 'teacher123';
  let students = [];
  let attendance = {};
  let todayDate = new Date().toISOString().split('T')[0];
  let editingStudentId = null;

  const loginBtn = document.getElementById('loginBtn');
  const saveStudentBtn = document.getElementById('saveStudentBtn');

  function escapeCSV(value) {
    if (typeof value !== 'string') return value;
    return `"${value.replace(/"/g, '""')}"`;
  }

  function checkPassword() {
    const pass = document.getElementById('adminPass').value;
    if (pass === ADMIN_PASSWORD) {
      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('adminContent').style.display = 'block';
      initAdmin();
    } else {
      document.getElementById('loginMsg').textContent = 'Incorrect password!';
    }
  }

  function logout() {
    document.getElementById('adminContent').style.display = 'none';
    document.getElementById('loginDiv').style.display = 'block';
    document.getElementById('adminPass').value = '';
  }

  async function loadStudents() {
    try {
      const res = await fetch('https://attendance-app-5w9d.onrender.com/api/students');
      students = await res.json();
    } catch (e) {
      alert('Failed to load students.');
    }
  }

  async function loadAllAttendance() {
    try {
      const res = await fetch("https://attendance-app-5w9d.onrender.com/api/attendance");
      const data = await res.json();
      const all = {};
      data.forEach(entry => {
        all[entry.date] = entry.records;
      });
      localStorage.setItem('allAttendance', JSON.stringify(all));
    } catch {
      alert('Failed to load attendance data.');
    }
  }

  async function loadAttendance() {
    try {
      const res = await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance?date=${todayDate}`);
      const data = await res.json();
      attendance = (data.length > 0) ? data[0].records : {};
    } catch {
      attendance = {};
    }
  }

  async function saveAttendanceForDate(date, records) {
    const payload = { date, records };
    try {
      const res = await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance?date=${encodeURIComponent(date)}`);
      const data = await res.json();
      if (data.length && data[0].id) {
        await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance/${data[0].id}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
      } else {
        await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
      }
    } catch {
      alert('Failed to save attendance.');
    }
  }

  async function saveAttendance() {
    const res = await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance?date=${encodeURIComponent(todayDate)}`);
    const data = await res.json();
    const payload = { date: todayDate, records: attendance };

    if (data.length && data[0].id) {
      await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance/${data[0].id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
    } else {
      await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
    }
    await loadAttendance();
    renderTable();
    generateLiveMonthlyDashboard();
    localStorage.setItem('updated', Date.now());
  }

  function renderTable() {
    const tbody = document.getElementById('attendanceTableBody');
    tbody.innerHTML = '';
    students.forEach(student => {
      const time = attendance[student.id];
      const tr = document.createElement('tr');
      tr.className = time ? 'present' : 'absent';
      tr.innerHTML = `
        <td>${escapeHTML(student.id)}</td>
        <td>${escapeHTML(student.name)}</td>
        <td>${escapeHTML(student.mobile || '')}</td>
        <td>${time ? 'Present at ' + escapeHTML(time) : 'Absent'}</td>
        <td>
          <button class="toggle-btn" onclick="toggleAttendance('${escapeJS(student.id)}')">Mark ${time ? 'Absent' : 'Present'}</button>
          <button class="edit-btn" onclick="showEditModal('${escapeJS(student.id)}')">Edit</button>
          <button class="delete-btn" onclick="deleteStudent('${escapeJS(student.id)}')">Delete</button>
          <button class="edit-btn" onclick="triggerPhotoUpload('${escapeJS(student.id)}')">üì∑ Upload Photo</button>
          <input type="file" id="photoInput_${escapeHTMLAttr(student.id)}" style="display:none" accept="image/*" onchange="uploadStudentPhoto('${escapeJS(student.id)}', this.files[0])" />
        </td>
        <td>
          <img src="${student.photo ? escapeHTML(student.photo) : 'https://cdn-icons-png.flaticon.com/512/149/149071.png'}" width="40" height="40" style="border-radius:50%;" />
        </td>
      `;
      tbody.appendChild(tr);
    });
    document.getElementById('dateDisplay').textContent = `Date: ${todayDate}`;
  }

  function escapeHTML(text) {
    return text.replace(/[&<>"']/g, (m) => ({
      '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
    })[m]);
  }
  function escapeHTMLAttr(text) {
    return text.replace(/"/g, '&quot;');
  }
  function escapeJS(text) {
    return text.replace(/'/g, "\\'");
  }

  async function toggleAttendance(id) {
    if (attendance[id]) delete attendance[id];
    else attendance[id] = new Date().toLocaleTimeString('en-GB', { hour12: false });
    await saveAttendance();
  }

  async function viewAttendanceByDate() {
    const date = document.getElementById('viewDate').value;
    if (!date) return alert('Please select a date.');
    try {
      const res = await fetch("https://attendance-app-5w9d.onrender.com/api/attendance");
      const data = await res.json();
      const all = {};
      data.forEach(entry => all[entry.date] = entry.records);
      localStorage.setItem('allAttendance', JSON.stringify(all));
      attendance = all[date] || {};
      todayDate = date;
      renderTable();
      generateLiveMonthlyDashboard();
    } catch {
      alert('Failed to load attendance data');
    }
  }

  async function exportAttendanceByDate() {
    const date = document.getElementById('exportDate').value;
    if (!date) return alert('Please select a date.');
    try {
      const res = await fetch(`https://attendance-app-5w9d.onrender.com/api/attendance?date=${encodeURIComponent(date)}`);
      const data = await res.json();
      if (data.length === 0) return alert('No attendance data for ' + date);
      const records = data[0].records;
      const rows = [['ID', 'Name', 'Mobile', 'Status', 'Time', 'Date']];
      students.forEach(s => {
        const time = records[s.id] || '';
        const status = time ? 'Present' : 'Absent';
        rows.push([s.id, s.name, s.mobile || '', status, time, date]);
      });
      const csv = rows.map(r => r.map(escapeCSV).join(',')).join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `attendance_${date}.csv`;
      a.click();
    } catch {
      alert('Failed to export CSV.');
    }
  }

  function generateMonthlyReport() {
    const monthInput = document.getElementById('monthPicker').value;
    if (!monthInput) return alert('Please select a month.');
    const all = JSON.parse(localStorage.getItem('allAttendance') || '{}');
    const [year, month] = monthInput.split('-');
    const filteredDates = Object.keys(all).filter(d => d.startsWith(`${year}-${month}`) && new Date(d).getDay() !== 0);
    const tbody = document.getElementById('monthlyTableBody');
    tbody.innerHTML = '';
    students.forEach(s => {
      let present = 0;
      filteredDates.forEach(d => { if (all[d]?.[s.id]) present++; });
      const total = filteredDates.length;
      const percent = total ? ((present / total) * 100).toFixed(1) : 0;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${escapeHTML(s.id)}</td><td>${escapeHTML(s.name)}</td>
        <td>${present}</td><td>${total}</td><td>${percent}%</td>
      `;
      tbody.appendChild(tr);
    });
    document.getElementById('monthlyTable').style.display = 'table';
  }

  function exportMonthlyCSV() {
    const rows = [['ID', 'Name', 'Present Days', 'Total Days', 'Attendance %']];
    const tbody = document.getElementById('monthlyTableBody');
    for (const tr of tbody.children) {
      const row = Array.from(tr.children).map(td => td.textContent);
      rows.push(row);
    }
    if (rows.length === 1) return alert('Please generate monthly report first.');
    const csv = rows.map(r => r.map(escapeCSV).join(',')).join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'monthly_attendance.csv';
    a.click();
  }

  function showAddModal() {
    editingStudentId = null;
    document.getElementById('modalTitle').textContent = 'Add Student';
    document.getElementById('studentIdInput').value = '';
    document.getElementById('studentIdInput').disabled = false;
    document.getElementById('studentNameInput').value = '';
    document.getElementById('studentMobileInput').value = '';
    document.getElementById('modalErrorMsg').textContent = '';
    document.getElementById('modalOverlay').style.display = 'flex';
  }

  function showEditModal(id) {
    const student = students.find(s => s.id === id);
    if (!student) return alert('Student not found');
    editingStudentId = id;
    document.getElementById('modalTitle').textContent = 'Edit Student';
    document.getElementById('studentIdInput').value = student.id;
    document.getElementById('studentIdInput').disabled = true;
    document.getElementById('studentNameInput').value = student.name;
    document.getElementById('studentMobileInput').value = student.mobile || '';
    document.getElementById('modalErrorMsg').textContent = '';
    document.getElementById('modalOverlay').style.display = 'flex';
  }

  function closeModal() {
    document.getElementById('modalOverlay').style.display = 'none';
  }

  async function saveStudent() {
    saveStudentBtn.disabled = true;
    const id = document.getElementById('studentIdInput').value.trim();
    const name = document.getElementById('studentNameInput').value.trim();
    const mobile = document.getElementById('studentMobileInput').value.trim();
    if (!id || !name) {
      document.getElementById('modalErrorMsg').textContent = 'ID and Name are required';
      saveStudentBtn.disabled = false;
      return;
    }
    if (mobile && !/^\d{10}$/.test(mobile)) {
      document.getElementById('modalErrorMsg').textContent = 'Mobile must be 10 digits';
      saveStudentBtn.disabled = false;
      return;
    }
    try {
      if (editingStudentId) {
        await fetch(`https://attendance-app-5w9d.onrender.com/api/students/${encodeURIComponent(editingStudentId)}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id, name, mobile })
        });
      } else {
        if (students.find(s => s.id === id)) {
          document.getElementById('modalErrorMsg').textContent = 'Student ID already exists';
          saveStudentBtn.disabled = false;
          return;
        }
        await fetch('https://attendance-app-5w9d.onrender.com/api/students', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id, name, mobile, photo: '' })
        });
      }
      await initAdmin();
      closeModal();
    } catch {
      alert('Failed to save student');
    } finally {
      saveStudentBtn.disabled = false;
    }
  }

  async function deleteStudent(id) {
    if (!confirm(`Delete student ${id}? This action cannot be undone.`)) return;
    try {
      await fetch(`https://attendance-app-5w9d.onrender.com/api/students/${encodeURIComponent(id)}`, {
        method: 'DELETE'
      });
      await initAdmin();
    } catch {
      alert('Failed to delete student');
    }
  }

  function triggerPhotoUpload(id) {
    const input = document.getElementById(`photoInput_${escapeHTMLAttr(id)}`);
    if (input) input.click();
  }

  async function uploadStudentPhoto(studentId, fileInput) {
  const file = fileInput.files[0];
  if (!file) return alert('Please select a photo to upload.');

  const formData = new FormData();
  formData.append('photo', file);

  try {
    const res = await fetch(`${BASE_URL}/api/students/${studentId}/uploadPhoto`, {
      method: 'POST',
      body: formData,
    });
    if (!res.ok) throw new Error('Upload failed');

    const data = await res.json();
    alert('Photo uploaded successfully!');

    // Refresh student list or photo display as needed
    loadStudents();
  } catch (err) {
    alert('Photo upload error: ' + err.message);
  }
}

// Example usage: (attach this to your file input change event)
document.getElementById('photoInput').addEventListener('change', (e) => {
  const studentId = /* get selected student id */;
  const file = e.target.files[0];
  if (file) uploadStudentPhoto(studentId, file);
});


  function generateAllQRCodes() {
    const container = document.getElementById('qrCodeContainer');
    container.innerHTML = '';
    students.forEach(s => {
      const div = document.createElement('div');
      div.style.margin = '10px';
      div.style.display = 'inline-block';
      div.style.textAlign = 'center';
      const qrId = s.id.includes('/') ? s.id.split('/').pop() : s.id;
      const url = `https://qr-attendance.web.app/?id=${encodeURIComponent(qrId)}`;
      new QRCode(div, { text: url, width: 128, height: 128 });
      const label = document.createElement('div');
      label.textContent = `${s.name} (${qrId})`;
      div.appendChild(label);
      container.appendChild(div);
    });
  }

  async function downloadAllQRAsPDF() {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();
    let y = 10;
    for (const s of students) {
      const qrId = s.id.includes('/') ? s.id.split('/').pop() : s.id;
      const url = `https://qr-attendance.web.app/?id=${encodeURIComponent(qrId)}`;
      const qrDiv = document.createElement('div');
      new QRCode(qrDiv, { text: url, width: 128, height: 128 });
      await new Promise(res => setTimeout(res, 300));
      const canvas = qrDiv.querySelector('canvas');
      if (!canvas) continue;
      const imgData = canvas.toDataURL('image/png');
      if (y + 60 > pdf.internal.pageSize.height) {
        pdf.addPage();
        y = 10;
      }
      pdf.text(`${s.name} (${qrId})`, 10, y + 10);
      pdf.addImage(imgData, 'PNG', 10, y + 15, 40, 40);
      y += 60;
    }
    pdf.save('all_qr_codes.pdf');
  }

  function showIndividualQRModal() {
    const select = document.getElementById('studentQRSelect');
    select.innerHTML = '';
    students.forEach(s => {
      const option = document.createElement('option');
      option.value = s.id;
      option.textContent = `${s.name} (${s.id})`;
      select.appendChild(option);
    });
    document.getElementById('qrModal').style.display = 'flex';
  }

  function closeQRModal() {
    document.getElementById('qrModal').style.display = 'none';
    document.getElementById('qrCodeContainer').innerHTML = '';
  }

  function generateStudentQR() {
    const select = document.getElementById('studentQRSelect');
    const id = select.value;
    if (!id) return alert('Please select a student');
    const student = students.find(s => s.id === id);
    if (!student) return alert('Student not found');
    const qrId = student.id.includes('/') ? student.id.split('/').pop() : student.id;
    const url = `https://qr-attendance.web.app/?id=${encodeURIComponent(qrId)}`;
    const container = document.getElementById('qrCodeContainer');
    container.innerHTML = '';
    new QRCode(container, { text: url, width: 256, height: 256 });
  }

  function generateLiveMonthlyDashboard() {
    const monthInput = document.getElementById('monthPicker').value || todayDate.slice(0, 7);
    const [year, month] = monthInput.split('-');
    const allAttendance = JSON.parse(localStorage.getItem('allAttendance') || '{}');
    const datesInMonth = [];
    const daysInMonth = new Date(year, month, 0).getDate();
    for (let d = 1; d <= daysInMonth; d++) {
      const dateStr = `${year}-${month.padStart(2, '0')}-${String(d).padStart(2, '0')}`;
      const dayOfWeek = new Date(dateStr).getDay();
      if (dayOfWeek === 0) continue;
      datesInMonth.push(dateStr);
    }
    const thead = document.getElementById('liveTableHead');
    thead.innerHTML = '';
    const headerRow = document.createElement('tr');
    headerRow.innerHTML = '<th>ID</th><th>Name</th>' + datesInMonth.map(d => `<th>${d.slice(-2)}</th>`).join('');
    thead.appendChild(headerRow);

    const tbody = document.getElementById('liveTableBody');
    tbody.innerHTML = '';
    students.forEach(s => {
      const tr = document.createElement('tr');
      const cells = [`<td>${escapeHTML(s.id)}</td>`, `<td>${escapeHTML(s.name)}</td>`];
      datesInMonth.forEach(date => {
        const present = allAttendance[date]?.[s.id] ? true : false;
        cells.push(`<td class="${present ? 'present' : 'absent'}" onclick="toggleLiveAttendance('${escapeJS(s.id)}', '${date}')">${present ? '‚úîÔ∏è' : '‚ùå'}</td>`);
      });
      tr.innerHTML = cells.join('');
      tbody.appendChild(tr);
    });
  }

  async function toggleLiveAttendance(id, date) {
    const allAttendance = JSON.parse(localStorage.getItem('allAttendance') || '{}');
    if (!allAttendance[date]) allAttendance[date] = {};
    if (allAttendance[date][id]) delete allAttendance[date][id];
    else allAttendance[date][id] = new Date().toLocaleTimeString('en-GB', { hour12: false });
    localStorage.setItem('allAttendance', JSON.stringify(allAttendance));
    await saveAttendanceForDate(date, allAttendance[date]);
    generateLiveMonthlyDashboard();
    if (date === todayDate) {
      attendance = allAttendance[date];
      renderTable();
    }
  }

  async function initAdmin() {
    await loadStudents();
    await loadAllAttendance();
    await loadAttendance();
    renderTable();
    generateLiveMonthlyDashboard();
    populateStudentQRSelect();
    document.getElementById('viewDate').value = todayDate;
  }

  function populateStudentQRSelect() {
    const select = document.getElementById('studentQRSelect');
    select.innerHTML = '';
    students.forEach(s => {
      const option = document.createElement('option');
      option.value = s.id;
      option.textContent = `${s.name} (${s.id})`;
      select.appendChild(option);
    });
  }

  setInterval(() => {
    if (document.getElementById('adminContent').style.display === 'block') {
      initAdmin();
    }
  }, 30000);

  window.addEventListener('storage', (e) => {
    if (e.key === 'updated') {
      initAdmin();
    }
  });

  window.checkPassword = checkPassword;
  window.logout = logout;
  window.toggleAttendance = toggleAttendance;
  window.viewAttendanceByDate = viewAttendanceByDate;
  window.exportAttendanceByDate = exportAttendanceByDate;
  window.generateMonthlyReport = generateMonthlyReport;
  window.exportMonthlyCSV = exportMonthlyCSV;
  window.showAddModal = showAddModal;
  window.showEditModal = showEditModal;
  window.closeModal = closeModal;
  window.saveStudent = saveStudent;
  window.deleteStudent = deleteStudent;
  window.triggerPhotoUpload = triggerPhotoUpload;
  window.uploadStudentPhoto = uploadStudentPhoto;
  window.generateAllQRCodes = generateAllQRCodes;
  window.downloadAllQRAsPDF = downloadAllQRAsPDF;
  window.showIndividualQRModal = showIndividualQRModal;
  window.closeQRModal = closeQRModal;
  window.generateStudentQR = generateStudentQR;
  window.generateLiveMonthlyDashboard = generateLiveMonthlyDashboard;
  window.toggleLiveAttendance = toggleLiveAttendance;

})();
</script>

</body>
</html>
